# ob 撮合逻辑


# 深圳交易所

## 深圳可转债

- 可转债使用的价格笼子为除权除息之后的前收价

## 深圳主板



## 深圳创业板

- 使用的基准价为**即时揭示的价格**，这意味着每次有 order/cxl/trans 推送的时候，我们都需要去看一下 ob 的 `best-bid` 与 `best-ask` 是不是变化了，然后再去更新价格笼子
- 对于市价单的情况，有可能是先有一系列的 trans，然后再转化成限价单，为了对应一个 seq 只生成一个 snaps 的原则，我们需要的所有跟市价单相关的事件处理完成后，才去推送撮合的成交、并更新相应的 snaps
- 这里有一点是，在市价单撮合的过程中，会存在市价单被撤单，也同样需要更新价格笼子，然后再次撮合，但是我们需要把这次撮合的也标记成是因为市价单事件导致的 `trans-cache`，所以需要一起等到改市价单事件完成后一次性的推送和更新
-



# 上海交易所

## 上海可转债

## 上海股票


---

> 作者: william  
> URL: https://williamlfang.github.io/archives/2021-07-26-ob-%E6%92%AE%E5%90%88%E9%80%BB%E8%BE%91/  

